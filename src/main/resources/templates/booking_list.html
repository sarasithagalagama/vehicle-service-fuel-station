<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Bookings Management</title>

    <!-- Bootstrap & Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <style>
      :root {
        --bg: #eef2f7;
        --card: #ffffff;
        --primary: #6754e2;
        --primary-600: #5a49d3;
        --ok: #16a34a;
        --warn: #f59e0b;
        --info: #0ea5e9;
        --danger: #ef4444;
        --muted: #6b7280;
        --shadow: 0 10px 30px rgba(20, 20, 20, 0.08);
        --radius: 14px;
      }
      body {
        background: linear-gradient(180deg, #f5f7fb, #e9eff8 35%, #eef2f7) fixed;
        color: #334155;
        font-family: Inter, system-ui, Segoe UI, Roboto, Helvetica, Arial,
          sans-serif;
      }
      .app {
        max-width: 1200px;
        margin-inline: auto;
        padding: 28px;
      }
      .glass {
        background: var(--card);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
      }
      .header-card {
        padding: 22px 26px;
      }
      .title {
        font-weight: 800;
        color: #2f3142;
        letter-spacing: 0.2px;
      }
      .subtitle {
        color: var(--muted);
        font-size: 0.95rem;
      }
      .btn-primary {
        background: var(--primary);
        border-color: var(--primary);
      }
      .btn-primary:hover {
        background: var(--primary-600);
        border-color: var(--primary-600);
      }

      /* Stat cards */
      .stats {
        gap: 18px;
      }
      .stat {
        padding: 20px;
        border-radius: 16px;
        box-shadow: var(--shadow);
        background: var(--card);
      }
      .stat .icon {
        width: 38px;
        height: 38px;
        border-radius: 12px;
        display: grid;
        place-items: center;
        color: #fff;
      }
      .stat .kpi {
        font-size: 34px;
        font-weight: 800;
        line-height: 1;
        margin-top: 10px;
      }
      .stat small {
        color: var(--muted);
      }
      .icon-pending {
        background: #fbbf24;
      }
      .icon-progress {
        background: #38bdf8;
      }
      .icon-done {
        background: #22c55e;
      }
      .icon-cancel {
        background: #ef4444;
      }

      /* Card */
      .card-block {
        padding: 22px 26px;
      }
      .toolbar {
        gap: 12px;
      }
      .form-control,
      .form-select {
        border-radius: 10px;
      }

      /* Table */
      table {
        --bs-table-bg: transparent;
      }
      thead th {
        font-size: 0.73rem;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        color: #6b7280;
      }
      tbody tr:hover {
        background: #f7f8ff;
      }
      .status-pill {
        font-weight: 700;
        font-size: 0.72rem;
        padding: 0.45rem 0.7rem;
        border-radius: 999px;
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
      }
      .pill-pending {
        background: #fff7e6;
        color: #92400e;
        border: 1px solid #fde68a;
      }
      .pill-progress {
        background: #e6f7ff;
        color: #075985;
        border: 1px solid #bae6fd;
      }
      .pill-completed {
        background: #ecfdf5;
        color: #065f46;
        border: 1px solid #bbf7d0;
      }
      .pill-cancelled {
        background: #fef2f2;
        color: #991b1b;
        border: 1px solid #fecaca;
      }

      .btn-chip {
        border-radius: 999px;
        padding: 0.35rem 0.65rem;
        font-weight: 600;
      }
      .btn-view {
        background: #ecfeff;
        color: #0369a1;
        border: 1px solid #bae6fd;
      }
      .btn-edit {
        background: #eef2ff;
        color: #4338ca;
        border: 1px solid #c7d2fe;
      }
      .btn-del {
        background: #fff1f2;
        color: #b91c1c;
        border: 1px solid #fecdd3;
      }
      .pagination .page-link {
        border: none;
        border-radius: 10px;
        box-shadow: var(--shadow);
        color: #4b5563;
      }
      .pagination .active .page-link {
        background: var(--primary);
        color: #fff;
      }
      @media (max-width: 768px) {
        .toolbar {
          flex-direction: column;
        }
      }
    </style>
  </head>

  <body>
    <main class="app">
      <!-- Header -->
      <section
        class="glass header-card d-flex justify-content-between align-items-center"
      >
        <div>
          <h2 class="title mb-1 d-flex align-items-center gap-2">
            <i class="bi bi-journal-check text-primary"></i> Bookings Management
          </h2>
          <p class="subtitle m-0">Manage and track all your service bookings</p>
        </div>
        <a
          th:href="@{/bookings/new}"
          class="btn btn-primary d-inline-flex align-items-center gap-2"
        >
          <i class="bi bi-plus-lg"></i> Add New Booking
        </a>
      </section>

      <!-- Stat cards -->
      <section
        class="mt-3 d-grid stats"
        style="grid-template-columns: repeat(4, 1fr)"
      >
        <div class="stat">
          <div class="d-flex align-items-center gap-3">
            <div class="icon icon-pending">
              <i class="bi bi-hourglass-split"></i>
            </div>
            <div>
              <div class="kpi" th:text="${pendingCount}"></div>
              <small>Pending Bookings</small>
            </div>
          </div>
        </div>
        <div class="stat">
          <div class="d-flex align-items-center gap-3">
            <div class="icon icon-progress">
              <i class="bi bi-play-circle"></i>
            </div>
            <div>
              <div class="kpi" th:text="${inProgressCount}"></div>
              <small>In Progress</small>
            </div>
          </div>
        </div>
        <div class="stat">
          <div class="d-flex align-items-center gap-3">
            <div class="icon icon-done">
              <i class="bi bi-check2-circle"></i>
            </div>
            <div>
              <div class="kpi" th:text="${completedCount}"></div>
              <small>Completed</small>
            </div>
          </div>
        </div>
        <div class="stat">
          <div class="d-flex align-items-center gap-3">
            <div class="icon icon-cancel"><i class="bi bi-x-octagon"></i></div>
            <div>
              <div class="kpi" th:text="${cancelledCount}"></div>
              <small>Cancelled</small>
            </div>
          </div>
        </div>
      </section>

      <!-- Table card -->
      <section class="glass mt-4">
        <div class="card-block">
          <!-- toolbar -->
          <div
            class="d-flex justify-content-between align-items-center toolbar mb-3 flex-wrap"
          >
            <h5 class="m-0 d-flex align-items-center gap-2">
              <i class="bi bi-list-check text-primary"></i> All Bookings
            </h5>

            <form class="d-flex gap-2" th:action="@{/bookings}" method="get">
              <div class="input-group">
                <span class="input-group-text bg-white border-end-0"
                  ><i class="bi bi-search"></i
                ></span>
                <input
                  class="form-control border-start-0"
                  name="q"
                  placeholder="Search by customer, vehicle, or service"
                  th:value="${q}"
                />
              </div>
              <select class="form-select" name="status" th:value="${status}">
                <option value="">All Status</option>
                <option>Pending</option>
                <option>In Progress</option>
                <option>Completed</option>
                <option>Cancelled</option>
              </select>
              <button class="btn btn-outline-secondary">Filter</button>
            </form>
          </div>

          <!-- table -->
          <div class="table-responsive">
            <table class="table align-middle">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Customer</th>
                  <th>Vehicle</th>
                  <th>Service Type</th>
                  <th>Status</th>
                  <th>Date &amp; Time</th>
                  <th class="text-end">Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr th:each="b : ${bookings}">
                  <td th:text="${'#' + b.id}"></td>
                  <td th:text="${b.customerName}"></td>
                  <td th:text="${b.vehicleNumber}"></td>
                  <td th:text="${b.serviceType}"></td>
                  <td>
                    <span
                      class="status-pill"
                      th:classappend="${b.status}=='Pending' ? ' pill-pending' :
                                      (${b.status}=='In Progress' ? ' pill-progress' :
                                      (${b.status}=='Completed' ? ' pill-completed' : ' pill-cancelled'))"
                      th:text="${b.status}"
                    ></span>
                  </td>
                  <td
                    th:text="${#temporals.format(b.bookingDate,'yyyy-MM-dd hh:mm a')}"
                  ></td>
                  <td class="text-end">
                    <a
                      th:href="@{'/bookings/edit/' + ${b.id}}"
                      class="btn btn-chip btn-edit me-1"
                    >
                      <i class="bi bi-pencil-square"></i> Edit
                    </a>
                    <a
                      th:href="@{'/bookings/delete/' + ${b.id}}"
                      onclick="return confirm('Delete this booking?')"
                      class="btn btn-chip btn-del"
                    >
                      <i class="bi bi-trash"></i> Delete
                    </a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- pagination -->
          <nav th:if="${totalPages > 1}" class="mt-3">
            <ul class="pagination justify-content-center gap-2">
              <li class="page-item" th:classappend="${page==0} ? 'disabled'">
                <a
                  class="page-link"
                  th:href="@{/bookings(page=${page-1}, q=${q}, status=${status})}"
                >
                  <i class="bi bi-chevron-left"></i>
                </a>
              </li>

              <li
                class="page-item"
                th:each="i: ${#numbers.sequence(0, totalPages-1)}"
                th:classappend="${i==page} ? 'active'"
              >
                <a
                  class="page-link"
                  th:text="${i+1}"
                  th:href="@{/bookings(page=${i}, q=${q}, status=${status})}"
                ></a>
              </li>

              <li
                class="page-item"
                th:classappend="${page==totalPages-1} ? 'disabled'"
              >
                <a
                  class="page-link"
                  th:href="@{/bookings(page=${page+1}, q=${q}, status=${status})}"
                >
                  <i class="bi bi-chevron-right"></i>
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
